<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ˆ Chart Trading Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .money {
            font-size: 18px;
            font-weight: bold;
            transition: all 0.2s ease-out;
        }
        
        .profit {
            font-size: 16px;
            font-weight: bold;
            transition: all 0.2s ease-out;
        }
        
        .profit.positive {
            color: #4ade80;
        }
        
        .profit.negative {
            color: #f87171;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            height: 250px;
            position: relative;
        }
        
        .chart-canvas {
            width: 100%;
            height: 100%;
            transition: all 0.1s ease-out;
        }
        
        .time-level-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .timer {
            font-size: 20px;
            font-weight: bold;
        }
        
        .level {
            font-size: 14px;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            flex: 1;
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-buy {
            background: linear-gradient(135deg, #4ade80, #22c55e);
            color: white;
        }
        
        .btn-buy:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
        }
        
        .btn-sell {
            background: linear-gradient(135deg, #f87171, #ef4444);
            color: white;
        }
        
        .btn-sell:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }
        
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .game-over-content {
            background: white;
            color: black;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 300px;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- ìƒíƒœë°” -->
        <div class="status-bar">
            <div class="money">ğŸ’° $<span id="currentMoney">10000</span></div>
            <div class="profit" id="profitDisplay">ğŸ“ˆ 0%</div>
        </div>
        
        <!-- ì°¨íŠ¸ ì˜ì—­ -->
        <div class="chart-container">
            <canvas id="chartCanvas" class="chart-canvas"></canvas>
        </div>
        
        <!-- ì‹œê°„/ë ˆë²¨ ë°” -->
        <div class="time-level-bar">
            <div class="timer">â° <span id="timeDisplay">01:00</span></div>
            <div class="level">ğŸ¯ Round <span id="roundDisplay">1</span></div>
        </div>
        
        <!-- ì¡°ì‘ ë²„íŠ¼ -->
        <div class="control-buttons">
            <button class="btn btn-buy" id="buyBtn">ğŸ“ˆ BUY</button>
            <button class="btn btn-sell" id="sellBtn" disabled>ğŸ“‰ SELL</button>
        </div>
    </div>
    
    <!-- ê²Œì„ ì˜¤ë²„ í™”ë©´ -->
    <div class="game-over" id="gameOverScreen">
        <div class="game-over-content">
            <h2>ğŸ® Round Complete!</h2>
            <p id="finalResult"></p>
            <button class="restart-btn" onclick="startNewGame()">ğŸ”„ Next Round</button>
        </div>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ
        let gameState = {
            cash: 10000,
            stocks: 0,
            stockPrice: 100,
            timeLeft: 45,
            round: 1,
            gameRunning: false,
            chartData: [],
            maxTime: 45
        };
        
        // DOM ìš”ì†Œ
        const canvas = document.getElementById('chartCanvas');
        const ctx = canvas.getContext('2d');
        const currentMoneyEl = document.getElementById('currentMoney');
        const profitDisplayEl = document.getElementById('profitDisplay');
        const timeDisplayEl = document.getElementById('timeDisplay');
        const roundDisplayEl = document.getElementById('roundDisplay');
        const buyBtn = document.getElementById('buyBtn');
        const sellBtn = document.getElementById('sellBtn');
        const gameOverScreen = document.getElementById('gameOverScreen');
        
        // Canvas í¬ê¸° ì„¤ì •
        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth - 40;
            canvas.height = container.clientHeight - 40;
        }
        
        // ê²Œì„ ì‹œì‘
        function startNewGame() {
            window.tickCount = 0;
            gameState = {
                cash: 10000,
                stocks: 0,
                stockPrice: 100,
                timeLeft: 45,
                round: gameState.round,
                gameRunning: true,
                chartData: [{price: 100, time: 0}],
                maxTime: 45
            };
            
            gameOverScreen.style.display = 'none';
            updateUI();
            resizeCanvas();
            
            // ê²Œì„ íƒ€ì´ë¨¸ ì‹œì‘ (ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•´ 100msë§ˆë‹¤ ì—…ë°ì´íŠ¸)
            window.tickCount = 0;
            const gameTimer = setInterval(() => {
                if (!gameState.gameRunning) {
                    clearInterval(gameTimer);
                    return;
                }
                
                window.tickCount++;
                
                // 100msë§ˆë‹¤ ì‘ì€ ì£¼ê°€ ë³€ë™
                const smallChange = (Math.random() - 0.5) * 1.5;
                gameState.stockPrice = Math.max(10, gameState.stockPrice + smallChange);
                
                // 1ì´ˆë§ˆë‹¤ (10í‹±ë§ˆë‹¤) ì‹œê°„ ê°ì†Œ ë° ì°¨íŠ¸ ë°ì´í„° ì¶”ê°€
                if (window.tickCount % 10 === 0) {
                    gameState.timeLeft--;
                    gameState.chartData.push({
                        price: gameState.stockPrice,
                        time: gameState.maxTime - gameState.timeLeft
                    });
                }
                
                updateUI();
                drawChart();
                
                if (gameState.timeLeft <= 0) {
                    endGame();
                }
            }, 100);
        }
        
        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            const totalValue = gameState.cash + (gameState.stocks * gameState.stockPrice);
            const profit = ((totalValue - 10000) / 10000) * 100;
            
            currentMoneyEl.textContent = Math.round(totalValue);
            
            profitDisplayEl.textContent = `${profit >= 0 ? 'ğŸ“ˆ' : 'ğŸ“‰'} ${profit.toFixed(1)}%`;
            profitDisplayEl.className = `profit ${profit >= 0 ? 'positive' : 'negative'}`;
            
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            timeDisplayEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            roundDisplayEl.textContent = gameState.round;
            
            // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            buyBtn.disabled = gameState.cash < gameState.stockPrice || !gameState.gameRunning;
            sellBtn.disabled = gameState.stocks === 0 || !gameState.gameRunning;
        }
        
        // ì‹¤ì‹œê°„ ì°¨íŠ¸ ë°ì´í„° (ë§¤ 100msë§ˆë‹¤ ì—…ë°ì´íŠ¸)
        let realtimeData = [];
        
        // ì°¨íŠ¸ ê·¸ë¦¬ê¸° (ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ ë²„ì „)
        function drawChart() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ (í˜„ì¬ ê°€ê²©ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¶”ê°€)
            const currentTime = gameState.maxTime - gameState.timeLeft + (window.tickCount % 10) * 0.1;
            realtimeData = [...gameState.chartData, {price: gameState.stockPrice, time: currentTime}];
            
            if (realtimeData.length < 2) return;
            
            const padding = 20;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            
            // ê°€ê²© ë²”ìœ„ ê³„ì‚° (ì‹¤ì‹œê°„ ë°ì´í„° í¬í•¨)
            const prices = realtimeData.map(d => d.price);
            const minPrice = Math.min(...prices) * 0.95;
            const maxPrice = Math.max(...prices) * 1.05;
            const priceRange = maxPrice - minPrice;
            
            // ê·¸ë¦¬ë“œ ê·¸ë¦¬ê¸° (ë¶€ë“œëŸ¬ìš´ ê·¸ë¼ë°ì´ì…˜)
            const gradient = ctx.createLinearGradient(0, padding, 0, canvas.height - padding);
            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.05)');
            gradient.addColorStop(1, 'rgba(255, 255, 255, 0.1)');
            
            ctx.strokeStyle = gradient;
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + (chartHeight / 5) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
            
            // ì°¨íŠ¸ ì˜ì—­ ë°°ê²½ ê·¸ë¼ë°ì´ì…˜
            const chartGradient = ctx.createLinearGradient(0, padding, 0, canvas.height - padding);
            chartGradient.addColorStop(0, 'rgba(74, 222, 128, 0.1)');
            chartGradient.addColorStop(1, 'rgba(74, 222, 128, 0.01)');
            
            // ë¶€ë“œëŸ¬ìš´ ê³¡ì„  ë¼ì¸ ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#4ade80';
            ctx.lineWidth = 3;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.beginPath();
            
            // ë² ì§€ì–´ ê³¡ì„ ì„ ì‚¬ìš©í•œ ë¶€ë“œëŸ¬ìš´ ë¼ì¸
            realtimeData.forEach((point, index) => {
                const x = padding + (chartWidth / gameState.maxTime) * point.time;
                const y = padding + chartHeight - ((point.price - minPrice) / priceRange) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else if (index === 1) {
                    ctx.lineTo(x, y);
                } else {
                    // ë¶€ë“œëŸ¬ìš´ ê³¡ì„ ì„ ìœ„í•œ ë² ì§€ì–´ ê³¡ì„ 
                    const prevPoint = realtimeData[index - 1];
                    const prevX = padding + (chartWidth / gameState.maxTime) * prevPoint.time;
                    const prevY = padding + chartHeight - ((prevPoint.price - minPrice) / priceRange) * chartHeight;
                    
                    const cpX = (prevX + x) / 2;
                    ctx.quadraticCurveTo(cpX, prevY, x, y);
                }
            });
            
            ctx.stroke();
            
            // ì°¨íŠ¸ ì•„ë˜ ì˜ì—­ ì±„ìš°ê¸° (ê·¸ë¼ë°ì´ì…˜)
            ctx.globalAlpha = 0.3;
            ctx.fillStyle = chartGradient;
            ctx.fill();
            ctx.globalAlpha = 1.0;
            
            // í˜„ì¬ ê°€ê²© í¬ì¸íŠ¸ (í„ìŠ¤ íš¨ê³¼)
            if (realtimeData.length > 0) {
                const lastPoint = realtimeData[realtimeData.length - 1];
                const x = padding + (chartWidth / gameState.maxTime) * lastPoint.time;
                const y = padding + chartHeight - ((lastPoint.price - minPrice) / priceRange) * chartHeight;
                
                // í„ìŠ¤ íš¨ê³¼ë¥¼ ìœ„í•œ ì• ë‹ˆë©”ì´ì…˜
                const pulseSize = 3 + Math.sin(Date.now() * 0.01) * 2;
                
                // ì™¸ê³½ ì› (í„ìŠ¤)
                ctx.fillStyle = 'rgba(74, 222, 128, 0.3)';
                ctx.beginPath();
                ctx.arc(x, y, pulseSize + 3, 0, Math.PI * 2);
                ctx.fill();
                
                // ë‚´ë¶€ ì›
                ctx.fillStyle = '#4ade80';
                ctx.beginPath();
                ctx.arc(x, y, pulseSize, 0, Math.PI * 2);
                ctx.fill();
                
                // ê°€ê²© í…ìŠ¤íŠ¸ (ê·¸ë¦¼ì íš¨ê³¼)
                ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                ctx.shadowBlur = 4;
                ctx.fillStyle = 'white';
                ctx.font = 'bold 14px -apple-system';
                ctx.fillText(`$${lastPoint.price.toFixed(1)}`, x + 15, y - 10);
                ctx.shadowBlur = 0;
            }
        }
        
        // ë§¤ìˆ˜ í•¨ìˆ˜
        function buyStock() {
            if (gameState.cash >= gameState.stockPrice && gameState.gameRunning) {
                const stocksToBuy = Math.floor(gameState.cash / gameState.stockPrice);
                gameState.stocks += stocksToBuy;
                gameState.cash -= stocksToBuy * gameState.stockPrice;
                updateUI();
            }
        }
        
        // ë§¤ë„ í•¨ìˆ˜
        function sellStock() {
            if (gameState.stocks > 0 && gameState.gameRunning) {
                gameState.cash += gameState.stocks * gameState.stockPrice;
                gameState.stocks = 0;
                updateUI();
            }
        }
        
        // ê²Œì„ ì¢…ë£Œ
        function endGame() {
            gameState.gameRunning = false;
            
            const totalValue = gameState.cash + (gameState.stocks * gameState.stockPrice);
            const profit = totalValue - 10000;
            const profitPercent = (profit / 10000) * 100;
            
            let message = '';
            if (profitPercent > 20) {
                message = `ğŸ‰ Excellent! +${profitPercent.toFixed(1)}%`;
            } else if (profitPercent > 0) {
                message = `ğŸ‘ Good job! +${profitPercent.toFixed(1)}%`;
            } else if (profitPercent > -10) {
                message = `ğŸ˜ Not bad! ${profitPercent.toFixed(1)}%`;
            } else {
                message = `ğŸ˜… Try again! ${profitPercent.toFixed(1)}%`;
            }
            
            document.getElementById('finalResult').textContent = message;
            gameState.round++;
            gameOverScreen.style.display = 'flex';
        }
        
        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        buyBtn.addEventListener('click', buyStock);
        sellBtn.addEventListener('click', sellStock);
        window.addEventListener('resize', resizeCanvas);
        
        // ê²Œì„ ì‹œì‘
        startNewGame();
    </script>
</body>
</html>
